{"version":3,"sources":["webpack:///webpack/bootstrap 4e14dc5a3712b7a561e4","webpack:///./src/modules/adapter.js","webpack:///./src/modules/buffer.js","webpack:///./src/modules/elementRoutines.js","webpack:///./src/modules/jqLiteExtras.js","webpack:///./src/modules/viewport.js","webpack:///./src/modules/padding.js","webpack:///./src/ui-scroll.js"],"names":["getCtrlOnData","attr","element","onSyntax","match","length","window","console","log","ctrl","tail","candidate","candidateScope","scope","candidateName","target","source","parent","Error","Adapter","viewport","buffer","adjustBuffer","reload","$attr","$parse","$scope","isLoading","disabled","viewportScope","getScope","startScope","$parent","publicContext","assignAdapter","adapter","generatePublicContext","adapterAttr","replace","ctrlOnData","adapterOnScope","assign","error","message","angular","extend","publicMethods","i","bind","publicProps","property","Object","defineProperty","get","set","value","bof","eof","arg1","arg2","isFunction","slice","forEach","wrapper","applyUpdate","item","index","first","newItems","append","prepend","rowTop","topHeight","topDone","bottomDone","itemTop","offset","top","itemHeight","outerHeight","topDataPos","topVisiblePos","bottomVisiblePos","isEOF","isArray","keepIt","pos","indexOf","reverse","newItem","insert","op","ScrollBuffer","elementRoutines","bufferSize","create","Array","prototype","size","reset","startIndex","remove","next","minIndex","maxIndex","minIndexUser","maxIndexUser","items","Math","max","min","operation","splice","push","unshift","isNumber","removeElement","removeElementAnimated","effectiveHeight","elements","Number","MAX_VALUE","bottom","MIN_VALUE","offsetParent","ElementRoutines","$injector","$q","$animate","has","isAngularVersionLessThen1_3","version","major","minor","newElement","previousElement","after","$destroy","insertElement","deferred","defer","enter","resolve","promise","leave","then","JQLiteExtras","convertToPx","css","getStyle","isWindow","name","self","elem","nodeType","style","call","obj","document","location","alert","setInterval","scrollTo","direction","left","method","prop","preserve","isDefined","documentElement","getComputedStyle","parseFloat","currentStyle","result","rs","rsLeft","core_pnum","rnumnonpx","RegExp","test","runtimeStyle","pixelLeft","getMeasurements","measure","base","borderA","borderB","computedMarginA","computedMarginB","computedStyle","dirA","dirB","marginA","marginB","paddingA","paddingB","height","width","padding","border","margin","offsetWidth","offsetHeight","getWidthHeight","measurements","outer","outerfull","before","newElem","children","j","ref","contents","outerHTML","option","outerWidth","docElem","win","box","doc","ownerDocument","arguments","undefined","getBoundingClientRect","defaultView","parentWindow","pageYOffset","scrollTop","clientTop","pageXOffset","scrollLeft","clientLeft","key","Viewport","viewportController","$rootScope","topPadding","bottomPadding","container","bufferPadding","createPaddingElements","template","applyContainerStyle","bottomDataPos","scrollHeight","e","sibling","insertElementAnimated","shouldLoadBottom","clipBottom","overage","overageHeight","emptySpaceHeight","cache","add","adjustPadding","shouldLoadTop","clipTop","topPaddingHeight","reduce","summ","bottomPaddingHeight","visibleItemsHeight","averageItemHeight","adjustTopPadding","adjustBottomPadding","topPaddingHeightAdd","bottomPaddingHeightAdd","adjustScrollTopAfterMinIndexSet","topPaddingHeightOld","diff","adjustScrollTopAfterPrepend","updates","prepended","paddingHeight","resetTopPadding","clear","resetBottomPadding","removeItem","Padding","Cache","$index","sort","a","b","tagName","toLowerCase","table","find","module","service","run","jqLiteExtras","jQuery","registerFor","directive","restrict","controller","child","$timeout","require","transclude","priority","terminal","link","controllers","linker","uiScroll","parseNumericAttr","defaultValue","isNaN","BUFFER_MIN","BUFFER_DEFAULT","PADDING_MIN","PADDING_DEFAULT","datasource","itemName","datasourceName","ridActual","pending","isDatasourceValid","isObject","indexStore","propName","propUserName","descriptor","getOwnPropertyDescriptor","fetchNext","success","count","fetchPrevious","clone","$on","unbindEvents","unbind","wheelHandler","isInvalid","rid","$$destroyed","bindEvents","resizeAndScrollHandler","isElementVisible","visibilityWatcher","unregisterVisibilityWatcher","insertWrapperContent","insertAfter","createElement","$watch","addClass","promises","transform","tdInitializer","uiScrollTdInitializer","linking","onLink","updateDOM","toBePrepended","toBeRemoved","inserted","concat","removed","animated","updatePaddings","all","enqueueFetch","fetch","loading","$applyAsync","w","removeClass","calculateProperties","adjustBufferAfterFetch","shift","$$phase","$apply","event","yMax","clientHeight","preventDefault"],"mappings":"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","file":"ui-scroll.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 4e14dc5a3712b7a561e4","function getCtrlOnData(attr, element) {\r\n  let onSyntax = attr.match(/^(.+)(\\s+on\\s+)(.+)?/);\r\n  if (onSyntax && onSyntax.length === 4) {\r\n    window.console.log('Angular ui-scroll adapter assignment warning. \"Controller On\" syntax has been deprecated since ui-scroll v1.6.1.');\r\n    let ctrl = onSyntax[3];\r\n    let tail = onSyntax[1];\r\n    let candidate = element;\r\n    while (candidate.length) {\r\n      let candidateScope = candidate.scope(); // doesn't work when debugInfoEnabled flag = true\r\n      let candidateName = (candidate.attr('ng-controller') || '').match(/(\\w(?:\\w|\\d)*)(?:\\s+as\\s+(\\w(?:\\w|\\d)*))?/);\r\n      if (candidateName && candidateName[1] === ctrl) {\r\n        return {\r\n          target: candidateScope,\r\n          source: tail\r\n        };\r\n      }\r\n      candidate = candidate.parent();\r\n    }\r\n    throw new Error('Angular ui-scroll adapter assignment error. Failed to locate target controller \"' + ctrl + '\" to inject \"' + tail + '\"');\r\n  }\r\n}\r\n\r\nclass Adapter {\r\n\r\n  constructor(viewport, buffer, adjustBuffer, reload, $attr, $parse, element, $scope) {\r\n    this.viewport = viewport;\r\n    this.buffer = buffer;\r\n    this.adjustBuffer = adjustBuffer;\r\n    this.reload = reload;\r\n\r\n    this.isLoading = false;\r\n    this.disabled = false;\r\n\r\n    const viewportScope = viewport.getScope();\r\n    this.startScope = viewportScope.$parent ? viewportScope : $scope;\r\n\r\n    this.publicContext = {};\r\n    this.assignAdapter($attr.adapter, $parse, element);\r\n    this.generatePublicContext($attr, $parse);\r\n  }\r\n\r\n  assignAdapter(adapterAttr, $parse, element) {\r\n    if (!adapterAttr || !(adapterAttr = adapterAttr.replace(/^\\s+|\\s+$/gm, ''))) {\r\n      return;\r\n    }\r\n    let ctrlOnData = getCtrlOnData(adapterAttr, element);\r\n    let adapterOnScope;\r\n\r\n    try {\r\n      if (ctrlOnData) { // \"Controller On\", deprecated since v1.6.1\r\n        $parse(ctrlOnData.source).assign(ctrlOnData.target, {});\r\n        adapterOnScope = $parse(ctrlOnData.source)(ctrlOnData.target);\r\n      }\r\n      else {\r\n        $parse(adapterAttr).assign(this.startScope, {});\r\n        adapterOnScope = $parse(adapterAttr)(this.startScope);\r\n      }\r\n    }\r\n    catch (error) {\r\n      error.message = `Angular ui-scroll Adapter assignment exception.\\n` +\r\n        `Can't parse \"${adapterAttr}\" expression.\\n` +\r\n        error.message;\r\n      throw error;\r\n    }\r\n\r\n    angular.extend(adapterOnScope, this.publicContext);\r\n    this.publicContext = adapterOnScope;\r\n  }\r\n\r\n  generatePublicContext($attr, $parse) {\r\n    // these methods will be accessible out of ui-scroll via user defined adapter\r\n    const publicMethods = ['reload', 'applyUpdates', 'append', 'prepend', 'isBOF', 'isEOF', 'isEmpty'];\r\n    for (let i = publicMethods.length - 1; i >= 0; i--) {\r\n      this.publicContext[publicMethods[i]] = this[publicMethods[i]].bind(this);\r\n    }\r\n\r\n    // these read-only props will be accessible out of ui-scroll via user defined adapter\r\n    const publicProps = ['isLoading', 'topVisible', 'topVisibleElement', 'topVisibleScope', 'bottomVisible', 'bottomVisibleElement', 'bottomVisibleScope'];\r\n    for (let i = publicProps.length - 1; i >= 0; i--) {\r\n      let property, attr = $attr[publicProps[i]];\r\n      Object.defineProperty(this, publicProps[i], {\r\n        get: () => property,\r\n        set: (value) => {\r\n          property = value;\r\n          this.publicContext[publicProps[i]] = value;\r\n          if (attr) {\r\n            $parse(attr).assign(this.startScope, value);\r\n          }\r\n        }\r\n      });\r\n    }\r\n\r\n    // non-read-only public property\r\n    Object.defineProperty(this.publicContext, 'disabled', {\r\n      get: () => this.disabled,\r\n      set: (value) => (!(this.disabled = value)) ? this.adjustBuffer() : null\r\n    });\r\n  }\r\n\r\n  loading(value) {\r\n    this['isLoading'] = value;\r\n  }\r\n\r\n  isBOF() {\r\n    return this.buffer.bof;\r\n  }\r\n\r\n  isEOF() {\r\n    return this.buffer.eof;\r\n  }\r\n\r\n  isEmpty() {\r\n    return !this.buffer.length;\r\n  }\r\n\r\n  applyUpdates(arg1, arg2) {\r\n    if (angular.isFunction(arg1)) {\r\n      // arg1 is the updater function, arg2 is ignored\r\n      this.buffer.slice(0).forEach((wrapper) => {\r\n        // we need to do it on the buffer clone, because buffer content\r\n        // may change as we iterate through\r\n        this.applyUpdate(wrapper, arg1(wrapper.item, wrapper.scope, wrapper.element));\r\n      });\r\n    } else {\r\n      // arg1 is item index, arg2 is the newItems array\r\n      if (arg1 % 1 !== 0) {// checking if it is an integer\r\n        throw new Error('applyUpdates - ' + arg1 + ' is not a valid index');\r\n      }\r\n\r\n      const index = arg1 - this.buffer.first;\r\n      if ((index >= 0 && index < this.buffer.length)) {\r\n        this.applyUpdate(this.buffer[index], arg2);\r\n      }\r\n    }\r\n\r\n    this.adjustBuffer();\r\n  }\r\n\r\n  append(newItems) {\r\n    this.buffer.append(newItems);\r\n    this.adjustBuffer();\r\n  }\r\n\r\n  prepend(newItems) {\r\n    this.buffer.prepend(newItems);\r\n    this.adjustBuffer();\r\n  }\r\n\r\n  calculateProperties() {\r\n    let rowTop = null, topHeight = 0;\r\n    let topDone = false, bottomDone = false;\r\n    const length = this.buffer.length;\r\n\r\n    for (let i = 0; i < length; i++) {\r\n      const item = this.buffer[i];\r\n      const itemTop = item.element.offset().top;\r\n\r\n      if (rowTop !== itemTop) { // a new row condition\r\n        const itemHeight = item.element.outerHeight(true);\r\n        const top = this.viewport.topDataPos() + topHeight + itemHeight;\r\n\r\n        if (!topDone && top > this.viewport.topVisiblePos()) {\r\n          topDone = true;\r\n          this['topVisible'] = item.item;\r\n          this['topVisibleElement'] = item.element;\r\n          this['topVisibleScope'] = item.scope;\r\n        }\r\n\r\n        if (!bottomDone && (top >= this.viewport.bottomVisiblePos() || (i === length - 1 && this.isEOF()))) {\r\n          bottomDone = true;\r\n          this['bottomVisible'] = item.item;\r\n          this['bottomVisibleElement'] = item.element;\r\n          this['bottomVisibleScope'] = item.scope;\r\n        }\r\n        topHeight += itemHeight;\r\n      }\r\n\r\n      rowTop = itemTop;\r\n\r\n      if (topDone && bottomDone) {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  applyUpdate(wrapper, newItems) {\r\n    if (!angular.isArray(newItems)) {\r\n      return;\r\n    }\r\n\r\n    let keepIt;\r\n    let pos = (this.buffer.indexOf(wrapper)) + 1;\r\n\r\n    newItems.reverse().forEach((newItem) => {\r\n      if (newItem === wrapper.item) {\r\n        keepIt = true;\r\n        pos--;\r\n      } else {\r\n        this.buffer.insert(pos, newItem);\r\n      }\r\n    });\r\n\r\n    if (!keepIt) {\r\n      wrapper.op = 'remove';\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default Adapter;\n\n\n// WEBPACK FOOTER //\n// ./src/modules/adapter.js","export default function ScrollBuffer(elementRoutines, bufferSize) {\r\n  const buffer = Object.create(Array.prototype);\r\n\r\n  angular.extend(buffer, {\r\n    size: bufferSize,\r\n\r\n    reset(startIndex) {\r\n      buffer.remove(0, buffer.length);\r\n      buffer.eof = false;\r\n      buffer.bof = false;\r\n      buffer.first = startIndex;\r\n      buffer.next = startIndex;\r\n      buffer.minIndex = startIndex;\r\n      buffer.maxIndex = startIndex;\r\n      buffer.minIndexUser = null;\r\n      buffer.maxIndexUser = null;\r\n    },\r\n\r\n    append(items) {\r\n      items.forEach((item) => {\r\n        ++buffer.next;\r\n        buffer.insert('append', item);\r\n      });\r\n      buffer.maxIndex = buffer.eof ? buffer.next - 1 : Math.max(buffer.next - 1, buffer.maxIndex);\r\n    },\r\n\r\n    prepend(items) {\r\n      items.reverse().forEach((item) => {\r\n        --buffer.first;\r\n        buffer.insert('prepend', item);\r\n      });\r\n      buffer.minIndex = buffer.bof ? buffer.minIndex = buffer.first : Math.min(buffer.first, buffer.minIndex);\r\n    },\r\n\r\n    /**\r\n     * inserts wrapped element in the buffer\r\n     * the first argument is either operation keyword (see below) or a number for operation 'insert'\r\n     * for insert the number is the index for the buffer element the new one have to be inserted after\r\n     * operations: 'append', 'prepend', 'insert', 'remove', 'update', 'none'\r\n     */\r\n    insert(operation, item) {\r\n      const wrapper = {\r\n        item: item\r\n      };\r\n\r\n      if (operation % 1 === 0) {// it is an insert\r\n        wrapper.op = 'insert';\r\n        buffer.splice(operation, 0, wrapper);\r\n      } else {\r\n        wrapper.op = operation;\r\n        switch (operation) {\r\n          case 'append':\r\n            buffer.push(wrapper);\r\n            break;\r\n          case 'prepend':\r\n            buffer.unshift(wrapper);\r\n            break;\r\n        }\r\n      }\r\n    },\r\n\r\n    // removes elements from buffer\r\n    remove(arg1, arg2) {\r\n      if (angular.isNumber(arg1)) {\r\n        // removes items from arg1 (including) through arg2 (excluding)\r\n        for (let i = arg1; i < arg2; i++) {\r\n          elementRoutines.removeElement(buffer[i]);\r\n        }\r\n\r\n        return buffer.splice(arg1, arg2 - arg1);\r\n      }\r\n      // removes single item(wrapper) from the buffer\r\n      buffer.splice(buffer.indexOf(arg1), 1);\r\n\r\n      return elementRoutines.removeElementAnimated(arg1);\r\n    },\r\n\r\n    effectiveHeight(elements) {\r\n      if (!elements.length) {\r\n        return 0;\r\n      }\r\n      let top = Number.MAX_VALUE;\r\n      let bottom = Number.MIN_VALUE;\r\n      elements.forEach((wrapper) => {\r\n        if (wrapper.element[0].offsetParent) {\r\n          // element style is not display:none\r\n          top = Math.min(top, wrapper.element.offset().top);\r\n          bottom = Math.max(bottom, wrapper.element.offset().top + wrapper.element.outerHeight(true));\r\n        }\r\n      });\r\n      return Math.max(0, bottom - top);\r\n    }\r\n\r\n  });\r\n\r\n  return buffer;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/buffer.js","export default class ElementRoutines {\r\n\r\n  constructor($injector, $q) {\r\n    this.$animate = ($injector.has && $injector.has('$animate')) ? $injector.get('$animate') : null;\r\n    this.isAngularVersionLessThen1_3 = angular.version.major === 1 && angular.version.minor < 3;\r\n    this.$q = $q;\r\n  }\r\n\r\n  insertElement(newElement, previousElement) {\r\n    previousElement.after(newElement);\r\n    return [];\r\n  }\r\n\r\n  removeElement(wrapper) {\r\n    wrapper.element.remove();\r\n    wrapper.scope.$destroy();\r\n    return [];\r\n  }\r\n\r\n  insertElementAnimated(newElement, previousElement) {\r\n    if (!this.$animate) {\r\n      return this.insertElement(newElement, previousElement);\r\n    }\r\n\r\n    if (this.isAngularVersionLessThen1_3) {\r\n      const deferred = this.$q.defer();\r\n      // no need for parent - previous element is never null\r\n      this.$animate.enter(newElement, null, previousElement, () => deferred.resolve());\r\n\r\n      return [deferred.promise];\r\n    }\r\n\r\n    // no need for parent - previous element is never null\r\n    return [this.$animate.enter(newElement, null, previousElement)];\r\n  }\r\n\r\n  removeElementAnimated(wrapper) {\r\n    if (!this.$animate) {\r\n      return this.removeElement(wrapper);\r\n    }\r\n\r\n    if (this.isAngularVersionLessThen1_3) {\r\n      const deferred = this.$q.defer();\r\n      this.$animate.leave(wrapper.element, () => {\r\n        wrapper.scope.$destroy();\r\n        return deferred.resolve();\r\n      });\r\n\r\n      return [deferred.promise];\r\n    }\r\n\r\n    return [(this.$animate.leave(wrapper.element)).then(() => wrapper.scope.$destroy())];\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/elementRoutines.js","/*!\r\n globals: angular, window\r\n List of used element methods available in JQuery but not in JQuery Lite\r\n element.before(elem)\r\n element.height()\r\n element.outerHeight(true)\r\n element.height(value) = only for Top/Bottom padding elements\r\n element.scrollTop()\r\n element.scrollTop(value)\r\n */\r\n\r\nexport default class JQLiteExtras {\r\n\r\n  registerFor(element) {\r\n    let convertToPx, css, getStyle, isWindow;\r\n    // angular implementation blows up if elem is the window\r\n    css = angular.element.prototype.css;\r\n\r\n    element.prototype.css = function (name, value) {\r\n      let self = this;\r\n      let elem = self[0];\r\n      if (!(!elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style)) {\r\n        return css.call(self, name, value);\r\n      }\r\n    };\r\n\r\n    // as defined in angularjs v1.0.5\r\n    isWindow = (obj) => obj && obj.document && obj.location && obj.alert && obj.setInterval;\r\n\r\n    function scrollTo(self, direction, value) {\r\n      let elem = self[0];\r\n      let [method, prop, preserve] = {\r\n        top: [\r\n          'scrollTop',\r\n          'pageYOffset',\r\n          'scrollLeft'\r\n        ],\r\n        left: [\r\n          'scrollLeft',\r\n          'pageXOffset',\r\n          'scrollTop'\r\n        ]\r\n      }[direction];\r\n\r\n      if (isWindow(elem)) {\r\n        if (angular.isDefined(value)) {\r\n          return elem.scrollTo(self[preserve].call(self), value);\r\n        }\r\n        return (prop in elem) ? elem[prop] : elem.document.documentElement[method];\r\n      } else {\r\n        if (angular.isDefined(value)) {\r\n          elem[method] = value;\r\n        }\r\n        return elem[method];\r\n      }\r\n    }\r\n\r\n    if (window.getComputedStyle) {\r\n      getStyle = (elem) => window.getComputedStyle(elem, null);\r\n      convertToPx = (elem, value) => parseFloat(value);\r\n    } else {\r\n      getStyle = (elem) => elem.currentStyle;\r\n      convertToPx = (elem, value) => {\r\n        let left, result, rs, rsLeft, style;\r\n        let core_pnum = /[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/.source;\r\n        let rnumnonpx = new RegExp('^(' + core_pnum + ')(?!px)[a-z%]+$', 'i');\r\n\r\n        if (!rnumnonpx.test(value)) {\r\n          return parseFloat(value);\r\n        }\r\n\r\n        // ported from JQuery\r\n        style = elem.style;\r\n        left = style.left;\r\n        rs = elem.runtimeStyle;\r\n        rsLeft = rs && rs.left;\r\n        if (rs) {\r\n          rs.left = style.left;\r\n        }\r\n        // put in the new values to get a computed style out\r\n        style.left = value;\r\n        result = style.pixelLeft;\r\n        style.left = left;\r\n        if (rsLeft) {\r\n          rs.left = rsLeft;\r\n        }\r\n        return result;\r\n      };\r\n    }\r\n\r\n    function getMeasurements(elem, measure) {\r\n      let base, borderA, borderB, computedMarginA, computedMarginB, computedStyle, dirA, dirB, marginA, marginB, paddingA, paddingB;\r\n\r\n      if (isWindow(elem)) {\r\n        base = document.documentElement[{height: 'clientHeight', width: 'clientWidth'}[measure]];\r\n\r\n        return {\r\n          base: base,\r\n          padding: 0,\r\n          border: 0,\r\n          margin: 0\r\n        };\r\n      }\r\n\r\n      // Start with offset property\r\n      [\r\n        base,\r\n        dirA,\r\n        dirB\r\n      ] = {\r\n        width: [\r\n          elem.offsetWidth,\r\n          'Left',\r\n          'Right'\r\n        ],\r\n        height: [\r\n          elem.offsetHeight,\r\n          'Top',\r\n          'Bottom'\r\n        ]\r\n      }[measure];\r\n\r\n      computedStyle = getStyle(elem);\r\n      paddingA = convertToPx(elem, computedStyle['padding' + dirA]) || 0;\r\n      paddingB = convertToPx(elem, computedStyle['padding' + dirB]) || 0;\r\n      borderA = convertToPx(elem, computedStyle['border' + dirA + 'Width']) || 0;\r\n      borderB = convertToPx(elem, computedStyle['border' + dirB + 'Width']) || 0;\r\n      computedMarginA = computedStyle['margin' + dirA];\r\n      computedMarginB = computedStyle['margin' + dirB];\r\n\r\n      // I do not care for width for now, so this hack is irrelevant\r\n      // if ( !supportsPercentMargin )\r\n      // computedMarginA = hackPercentMargin( elem, computedStyle, computedMarginA )\r\n      // computedMarginB = hackPercentMargin( elem, computedStyle, computedMarginB )\r\n      marginA = convertToPx(elem, computedMarginA) || 0;\r\n      marginB = convertToPx(elem, computedMarginB) || 0;\r\n\r\n      return {\r\n        base: base,\r\n        padding: paddingA + paddingB,\r\n        border: borderA + borderB,\r\n        margin: marginA + marginB\r\n      };\r\n    }\r\n\r\n    function getWidthHeight(elem, direction, measure) {\r\n      let computedStyle, result;\r\n\r\n      let measurements = getMeasurements(elem, direction);\r\n\r\n      if (measurements.base > 0) {\r\n        return {\r\n          base: measurements.base - measurements.padding - measurements.border,\r\n          outer: measurements.base,\r\n          outerfull: measurements.base + measurements.margin\r\n        }[measure];\r\n      }\r\n\r\n      // Fall back to computed then uncomputed css if necessary\r\n      computedStyle = getStyle(elem);\r\n      result = computedStyle[direction];\r\n\r\n      if (result < 0 || result === null) {\r\n        result = elem.style[direction] || 0;\r\n      }\r\n\r\n      // Normalize \"\", auto, and prepare for extra\r\n      result = parseFloat(result) || 0;\r\n\r\n      return {\r\n        base: result - measurements.padding - measurements.border,\r\n        outer: result,\r\n        outerfull: result + measurements.padding + measurements.border + measurements.margin\r\n      }[measure];\r\n    }\r\n\r\n    // define missing methods\r\n    return angular.forEach({\r\n      before(newElem) {\r\n        var children, elem, i, j, parent, ref, self;\r\n        self = this;\r\n        elem = self[0];\r\n        parent = self.parent();\r\n        children = parent.contents();\r\n        if (children[0] === elem) {\r\n          return parent.prepend(newElem);\r\n        } else {\r\n          for (i = j = 1, ref = children.length - 1; 1 <= ref ? j <= ref : j >= ref; i = 1 <= ref ? ++j : --j) {\r\n            if (children[i] === elem) {\r\n              angular.element(children[i - 1]).after(newElem);\r\n              return;\r\n            }\r\n          }\r\n          throw new Error('invalid DOM structure ' + elem.outerHTML);\r\n        }\r\n      },\r\n      height (value){\r\n        var self;\r\n        self = this;\r\n        if (angular.isDefined(value)) {\r\n          if (angular.isNumber(value)) {\r\n            value = value + 'px';\r\n          }\r\n          return css.call(self, 'height', value);\r\n        } else {\r\n          return getWidthHeight(this[0], 'height', 'base');\r\n        }\r\n      },\r\n      outerHeight(option) {\r\n        return getWidthHeight(this[0], 'height', option ? 'outerfull' : 'outer');\r\n      },\r\n      outerWidth(option) {\r\n        return getWidthHeight(this[0], 'width', option ? 'outerfull' : 'outer');\r\n      },\r\n\r\n      /*\r\n       The offset setter method is not implemented\r\n       */\r\n      offset(value) {\r\n        let docElem, win;\r\n        let self = this;\r\n        let box = {\r\n          top: 0,\r\n          left: 0\r\n        };\r\n        let elem = self[0];\r\n        let doc = elem && elem.ownerDocument;\r\n\r\n        if (arguments.length) {\r\n          if (value === undefined) {\r\n            return self;\r\n          }\r\n          // TODO: implement setter\r\n          throw new Error('offset setter method is not implemented');\r\n        }\r\n\r\n        if (!doc) {\r\n          return;\r\n        }\r\n\r\n        docElem = doc.documentElement;\r\n\r\n        // TODO: Make sure it's not a disconnected DOM node\r\n\r\n        if (elem.getBoundingClientRect != null) {\r\n          box = elem.getBoundingClientRect();\r\n        }\r\n\r\n        win = doc.defaultView || doc.parentWindow;\r\n\r\n        return {\r\n          top: box.top + (win.pageYOffset || docElem.scrollTop) - (docElem.clientTop || 0),\r\n          left: box.left + (win.pageXOffset || docElem.scrollLeft) - (docElem.clientLeft || 0)\r\n        };\r\n      },\r\n      scrollTop(value) {\r\n        return scrollTo(this, 'top', value);\r\n      },\r\n      scrollLeft(value) {\r\n        return scrollTo(this, 'left', value);\r\n      }\r\n    }, (value, key) => {\r\n      if (!element.prototype[key]) {\r\n        return element.prototype[key] = value;\r\n      }\r\n    });\r\n  }\r\n\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/jqLiteExtras.js","import Padding from './padding';\r\n\r\nexport default function Viewport(elementRoutines, buffer, element, viewportController, $rootScope, padding) {\r\n  let topPadding = null;\r\n  let bottomPadding = null;\r\n  const viewport = viewportController && viewportController.viewport ? viewportController.viewport : angular.element(window);\r\n  const container = viewportController && viewportController.container ? viewportController.container : undefined;\r\n  const scope = viewportController && viewportController.scope ? viewportController.scope : $rootScope;\r\n\r\n  viewport.css({\r\n    'overflow-anchor': 'none',\r\n    'overflow-y': 'auto',\r\n    'display': 'block'\r\n  });\r\n\r\n  function bufferPadding() {\r\n    return viewport.outerHeight() * padding; // some extra space to initiate preload\r\n  }\r\n\r\n  angular.extend(viewport, {\r\n    getScope() {\r\n      return scope;\r\n    },\r\n\r\n    createPaddingElements(template) {\r\n      topPadding = new Padding(template);\r\n      bottomPadding = new Padding(template);\r\n      element.before(topPadding);\r\n      element.after(bottomPadding);\r\n    },\r\n\r\n    applyContainerStyle() {\r\n      if (container && container !== viewport) {\r\n        viewport.css('height', window.getComputedStyle(container[0]).height);\r\n      }\r\n    },\r\n\r\n    bottomDataPos() {\r\n      let scrollHeight = viewport[0].scrollHeight;\r\n      scrollHeight = scrollHeight != null ? scrollHeight : viewport[0].document.documentElement.scrollHeight;\r\n      return scrollHeight - bottomPadding.height();\r\n    },\r\n\r\n    topDataPos() {\r\n      return topPadding.height();\r\n    },\r\n\r\n    bottomVisiblePos() {\r\n      return viewport.scrollTop() + viewport.outerHeight();\r\n    },\r\n\r\n    topVisiblePos() {\r\n      return viewport.scrollTop();\r\n    },\r\n\r\n    insertElement(e, sibling) {\r\n      return elementRoutines.insertElement(e, sibling || topPadding);\r\n    },\r\n\r\n    insertElementAnimated(e, sibling) {\r\n      return elementRoutines.insertElementAnimated(e, sibling || topPadding);\r\n    },\r\n\r\n    shouldLoadBottom() {\r\n      return !buffer.eof && viewport.bottomDataPos() < viewport.bottomVisiblePos() + bufferPadding();\r\n    },\r\n\r\n    clipBottom() {\r\n      // clip the invisible items off the bottom\r\n      let overage = 0;\r\n      let overageHeight = 0;\r\n      let itemHeight = 0;\r\n      let emptySpaceHeight = viewport.bottomDataPos() - viewport.bottomVisiblePos() - bufferPadding();\r\n\r\n      for (let i = buffer.length - 1; i >= 0; i--) {\r\n        itemHeight = buffer[i].element.outerHeight(true);\r\n        if (overageHeight + itemHeight > emptySpaceHeight) {\r\n          break;\r\n        }\r\n        bottomPadding.cache.add(buffer[i]);\r\n        overageHeight += itemHeight;\r\n        overage++;\r\n      }\r\n\r\n      if (overage > 0) {\r\n        buffer.eof = false;\r\n        buffer.remove(buffer.length - overage, buffer.length);\r\n        buffer.next -= overage;\r\n        viewport.adjustPadding();\r\n      }\r\n    },\r\n\r\n    shouldLoadTop() {\r\n      return !buffer.bof && (viewport.topDataPos() > viewport.topVisiblePos() - bufferPadding());\r\n    },\r\n\r\n    clipTop() {\r\n      // clip the invisible items off the top\r\n      let overage = 0;\r\n      let overageHeight = 0;\r\n      let itemHeight = 0;\r\n      let emptySpaceHeight = viewport.topVisiblePos() - viewport.topDataPos() - bufferPadding();\r\n\r\n      for (let i = 0; i < buffer.length; i++) {\r\n        itemHeight = buffer[i].element.outerHeight(true);\r\n        if (overageHeight + itemHeight > emptySpaceHeight) {\r\n          break;\r\n        }\r\n        topPadding.cache.add(buffer[i]);\r\n        overageHeight += itemHeight;\r\n        overage++;\r\n      }\r\n\r\n      if (overage > 0) {\r\n        // we need to adjust top padding element before items are removed from top\r\n        // to avoid strange behaviour of scroll bar during remove top items when we are at the very bottom\r\n        topPadding.height(topPadding.height() + overageHeight);\r\n        buffer.bof = false;\r\n        buffer.remove(0, overage);\r\n        buffer.first += overage;\r\n      }\r\n    },\r\n\r\n    adjustPadding() {\r\n      if (!buffer.length) {\r\n        return;\r\n      }\r\n\r\n      // precise heights calculation, items that were in buffer once\r\n      let topPaddingHeight = topPadding.cache.reduce((summ, item) => summ + (item.index < buffer.first ? item.height : 0), 0);\r\n      let bottomPaddingHeight = bottomPadding.cache.reduce((summ, item) => summ + (item.index >= buffer.next ? item.height : 0), 0);\r\n\r\n      // average item height based on buffer data\r\n      let visibleItemsHeight = buffer.reduce((summ, item) => summ + item.element.outerHeight(true), 0);\r\n      let averageItemHeight = (visibleItemsHeight + topPaddingHeight + bottomPaddingHeight) / (buffer.maxIndex - buffer.minIndex + 1);\r\n\r\n      // average heights calculation, items that have never been reached\r\n      let adjustTopPadding = buffer.minIndexUser !== null && buffer.minIndex > buffer.minIndexUser;\r\n      let adjustBottomPadding = buffer.maxIndexUser !== null && buffer.maxIndex < buffer.maxIndexUser;\r\n      let topPaddingHeightAdd = adjustTopPadding ? (buffer.minIndex - buffer.minIndexUser) * averageItemHeight : 0;\r\n      let bottomPaddingHeightAdd = adjustBottomPadding ? (buffer.maxIndexUser - buffer.maxIndex) * averageItemHeight : 0;\r\n\r\n      // paddings combine adjustment\r\n      topPadding.height(topPaddingHeight + topPaddingHeightAdd);\r\n      bottomPadding.height(bottomPaddingHeight + bottomPaddingHeightAdd);\r\n    },\r\n\r\n    adjustScrollTopAfterMinIndexSet(topPaddingHeightOld) {\r\n      // additional scrollTop adjustment in case of datasource.minIndex external set\r\n      if (buffer.minIndexUser !== null && buffer.minIndex > buffer.minIndexUser) {\r\n        let diff = topPadding.height() - topPaddingHeightOld;\r\n        viewport.scrollTop(viewport.scrollTop() + diff);\r\n      }\r\n    },\r\n\r\n    adjustScrollTopAfterPrepend(updates) {\r\n      if (!updates.prepended.length)\r\n        return;\r\n      const height = buffer.effectiveHeight(updates.prepended);\r\n      const paddingHeight = topPadding.height() - height;\r\n      if (paddingHeight >= 0) {\r\n        topPadding.height(paddingHeight);\r\n      }\r\n      else {\r\n        topPadding.height(0);\r\n        viewport.scrollTop(viewport.scrollTop() - paddingHeight);\r\n      }\r\n    },\r\n\r\n    resetTopPadding() {\r\n      topPadding.height(0);\r\n      topPadding.cache.clear();\r\n    },\r\n\r\n    resetBottomPadding() {\r\n      bottomPadding.height(0);\r\n      bottomPadding.cache.clear();\r\n    },\r\n\r\n    removeItem(item) {\r\n      topPadding.cache.remove(item);\r\n      bottomPadding.cache.remove(item);\r\n      return buffer.remove(item);\r\n    }\r\n  });\r\n\r\n  return viewport;\r\n}\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/viewport.js","function Cache() {\r\n  const cache = Object.create(Array.prototype);\r\n\r\n  angular.extend(cache, {\r\n    add(item) {\r\n      for (let i = cache.length - 1; i >= 0; i--) {\r\n        if (cache[i].index === item.scope.$index) {\r\n          cache[i].height = item.element.outerHeight();\r\n          return;\r\n        }\r\n      }\r\n      cache.push({\r\n        index: item.scope.$index,\r\n        height: item.element.outerHeight()\r\n      });\r\n      cache.sort((a, b) => ((a.index < b.index) ? -1 : ((a.index > b.index) ? 1 : 0)));\r\n    },\r\n\r\n    remove(item) {\r\n      for (let i = cache.length - 1; i >= 0; i--) {\r\n        if (cache[i].index === item.scope.$index) {\r\n          cache.splice(i, 1);\r\n          break;\r\n        }\r\n      }\r\n      for (let i = cache.length - 1; i >= 0; i--) {\r\n        if (cache[i].index > item.scope.$index) {\r\n          cache[i].index--;\r\n        }\r\n      }\r\n    },\r\n\r\n    clear() {\r\n      cache.length = 0;\r\n    }\r\n  });\r\n\r\n  return cache;\r\n}\r\n\r\nexport default function Padding(template) {\r\n  let result;\r\n\r\n  switch (template.tagName.toLowerCase()) {\r\n    case 'dl':\r\n      throw new Error(`ui-scroll directive does not support <${template.tagName}> as a repeating tag: ${template.outerHTML}`);\r\n    case 'tr':\r\n      let table = angular.element('<table><tr><td><div></div></td></tr></table>');\r\n      result = table.find('tr');\r\n      break;\r\n    case 'li':\r\n      result = angular.element('<li></li>');\r\n      break;\r\n    default:\r\n      result = angular.element('<div></div>');\r\n  }\r\n\r\n  result.cache = new Cache();\r\n\r\n  return result;\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/modules/padding.js","import JQLiteExtras from './modules/jqLiteExtras';\nimport ElementRoutines from './modules/elementRoutines.js';\nimport ScrollBuffer from './modules/buffer.js';\nimport Viewport from './modules/viewport.js';\nimport Adapter from './modules/adapter.js';\n\nangular.module('ui.scroll', [])\n\n  .service('jqLiteExtras', () => new JQLiteExtras())\n  .run(['jqLiteExtras', (jqLiteExtras) =>\n    !window.jQuery ? jqLiteExtras.registerFor(angular.element) : null\n  ])\n\n  .directive('uiScrollViewport', function () {\n    return {\n      restrict: 'A',\n      controller: [\n        '$scope',\n        '$element',\n        function (scope, element) {\n          this.container = element;\n          this.viewport = element;\n          this.scope = scope;\n\n          angular.forEach(element.children(), (child => {\n            if (child.tagName.toLowerCase() === 'tbody') {\n              this.viewport = angular.element(child);\n            }\n          }));\n\n          return this;\n        }\n      ]\n    };\n  })\n\n  .directive('uiScroll', [\n    '$log',\n    '$injector',\n    '$rootScope',\n    '$timeout',\n    '$q',\n    '$parse',\n    function (console, $injector, $rootScope, $timeout, $q, $parse) {\n\n      return {\n        require: ['?^uiScrollViewport'],\n        restrict: 'A',\n        transclude: 'element',\n        priority: 1000,\n        terminal: true,\n        link: link\n      };\n\n      function link($scope, element, $attr, controllers, linker) {\n        const match = $attr.uiScroll.match(/^\\s*(\\w+)\\s+in\\s+([(\\w|\\$)\\.]+)\\s*$/);\n        if (!match) {\n          throw new Error('Expected uiScroll in form of \\'_item_ in _datasource_\\' but got \\'' + $attr.uiScroll + '\\'');\n        }\n\n        function parseNumericAttr(value, defaultValue) {\n          let result = $parse(value)($scope);\n          return isNaN(result) ? defaultValue : result;\n        }\n\n        const BUFFER_MIN = 3;\n        const BUFFER_DEFAULT = 10;\n        const PADDING_MIN = 0.3;\n        const PADDING_DEFAULT = 0.5;\n\n        let datasource = null;\n        const itemName = match[1];\n        const datasourceName = match[2];\n        const viewportController = controllers[0];\n        const bufferSize = Math.max(BUFFER_MIN, parseNumericAttr($attr.bufferSize, BUFFER_DEFAULT));\n        const padding = Math.max(PADDING_MIN, parseNumericAttr($attr.padding, PADDING_DEFAULT));\n        let startIndex = parseNumericAttr($attr.startIndex, 1);\n        let ridActual = 0;// current data revision id\n        let pending = [];\n\n        let elementRoutines = new ElementRoutines($injector, $q);\n        let buffer = new ScrollBuffer(elementRoutines, bufferSize);\n        let viewport = new Viewport(elementRoutines, buffer, element, viewportController, $rootScope, padding);\n        let adapter = new Adapter(viewport, buffer, adjustBuffer, reload, $attr, $parse, element, $scope);\n\n        if (viewportController) {\n          viewportController.adapter = adapter;\n        }\n\n        let isDatasourceValid = () => angular.isObject(datasource) && angular.isFunction(datasource.get);\n        datasource = $parse(datasourceName)($scope); // try to get datasource on scope\n        if (!isDatasourceValid()) {\n          datasource = $injector.get(datasourceName); // try to inject datasource as service\n          if (!isDatasourceValid()) {\n            throw new Error(datasourceName + ' is not a valid datasource');\n          }\n        }\n\n        let indexStore = {};\n\n        function defineProperty(datasource, propName, propUserName) {\n          let descriptor = Object.getOwnPropertyDescriptor(datasource, propName);\n          if (!descriptor || (!descriptor.set && !descriptor.get)) {\n            Object.defineProperty(datasource, propName, {\n              set: (value) => {\n                indexStore[propName] = value;\n                $timeout(() => {\n                  buffer[propUserName] = value;\n                  if (!pending.length) {\n                    let topPaddingHeightOld = viewport.topDataPos();\n                    viewport.adjustPadding();\n                    if (propName === 'minIndex') {\n                      viewport.adjustScrollTopAfterMinIndexSet(topPaddingHeightOld);\n                    }\n                  }\n                });\n              },\n              get: () => indexStore[propName]\n            });\n          }\n        }\n\n        defineProperty(datasource, 'minIndex', 'minIndexUser');\n        defineProperty(datasource, 'maxIndex', 'maxIndexUser');\n\n        const fetchNext = (datasource.get.length !== 2) ? (success) => datasource.get(buffer.next, bufferSize, success)\n          : (success) => {\n          datasource.get({\n            index: buffer.next,\n            append: buffer.length ? buffer[buffer.length - 1].item : void 0,\n            count: bufferSize\n          }, success);\n        };\n\n        const fetchPrevious = (datasource.get.length !== 2) ? (success) => datasource.get(buffer.first - bufferSize, bufferSize, success)\n          : (success) => {\n          datasource.get({\n            index: buffer.first - bufferSize,\n            prepend: buffer.length ? buffer[0].item : void 0,\n            count: bufferSize\n          }, success);\n        };\n\n        /**\n         * Build padding elements\n         *\n         * Calling linker is the only way I found to get access to the tag name of the template\n         * to prevent the directive scope from pollution a new scope is created and destroyed\n         * right after the builder creation is completed\n         */\n        linker((clone, scope) => {\n          viewport.createPaddingElements(clone[0]);\n          // we do not include the clone in the DOM. It means that the nested directives will not\n          // be able to reach the parent directives, but in this case it is intentional because we\n          // created the clone to access the template tag name\n          scope.$destroy();\n          clone.remove();\n        });\n\n        $scope.$on('$destroy', () => {\n          unbindEvents();\n          viewport.unbind('mousewheel', wheelHandler);\n        });\n\n        viewport.bind('mousewheel', wheelHandler);\n\n        $timeout(() => {\n          viewport.applyContainerStyle();\n          reload();\n        });\n\n        /* Private function definitions */\n\n        function isInvalid(rid) {\n          return (rid && rid !== ridActual) || $scope.$$destroyed;\n        }\n\n        function bindEvents() {\n          viewport.bind('resize', resizeAndScrollHandler);\n          viewport.bind('scroll', resizeAndScrollHandler);\n        }\n\n        function unbindEvents() {\n          viewport.unbind('resize', resizeAndScrollHandler);\n          viewport.unbind('scroll', resizeAndScrollHandler);\n        }\n\n        function reload() {\n          viewport.resetTopPadding();\n          viewport.resetBottomPadding();\n          if (arguments.length) {\n            startIndex = arguments[0];\n          }\n          buffer.reset(startIndex);\n          adjustBuffer();\n        }\n\n        function isElementVisible(wrapper) {\n          return wrapper.element.height() && wrapper.element[0].offsetParent;\n        }\n\n        function visibilityWatcher(wrapper) {\n          if (isElementVisible(wrapper)) {\n            buffer.forEach((item) => {\n              if (angular.isFunction(item.unregisterVisibilityWatcher)) {\n                item.unregisterVisibilityWatcher();\n                delete item.unregisterVisibilityWatcher;\n              }\n            });\n            if (!pending.length) {\n              $timeout(() => adjustBuffer());\n            }\n          }\n        }\n\n        function insertWrapperContent(wrapper, insertAfter) {\n          createElement(wrapper, insertAfter, viewport.insertElement);\n          if (!isElementVisible(wrapper)) {\n            wrapper.unregisterVisibilityWatcher = wrapper.scope.$watch(() => visibilityWatcher(wrapper));\n          }\n          wrapper.element.addClass('ng-hide'); // hide inserted elements before data binding\n        }\n\n        function createElement(wrapper, insertAfter, insertElement) {\n          let promises = null;\n          let sibling = (insertAfter > 0) ? buffer[insertAfter - 1].element : undefined;\n          linker((clone, scope) => {\n            promises = insertElement(clone, sibling);\n            wrapper.element = clone;\n            wrapper.scope = scope;\n            scope[itemName] = wrapper.item;\n          });\n          // ui-scroll-grid apply\n          if (adapter.transform) {\n            let tdInitializer = wrapper.scope.uiScrollTdInitializer;\n            if (tdInitializer && tdInitializer.linking) {\n              adapter.transform(wrapper.scope, wrapper.element);\n            } else {\n              wrapper.scope.uiScrollTdInitializer = {\n                onLink: () => adapter.transform(wrapper.scope, wrapper.element),\n                scope: wrapper.scope\n              };\n            }\n          }\n          return promises;\n        }\n\n        function updateDOM() {\n          let promises = [];\n          const toBePrepended = [];\n          const toBeRemoved = [];\n          const inserted = [];\n\n          buffer.forEach((wrapper, i) => {\n            switch (wrapper.op) {\n              case 'prepend':\n                toBePrepended.unshift(wrapper);\n                break;\n              case 'append':\n                insertWrapperContent(wrapper, i);\n                wrapper.op = 'none';\n                inserted.push(wrapper);\n                break;\n              case 'insert':\n                promises = promises.concat(createElement(wrapper, i, viewport.insertElementAnimated));\n                wrapper.op = 'none';\n                inserted.push(wrapper);\n                break;\n              case 'remove':\n                toBeRemoved.push(wrapper);\n            }\n          });\n\n          toBeRemoved.forEach((wrapper) => promises = promises.concat(viewport.removeItem(wrapper)));\n\n          if (toBePrepended.length)\n            toBePrepended.forEach((wrapper) => {\n              insertWrapperContent(wrapper);\n              wrapper.op = 'none';\n            });\n\n          buffer.forEach((item, i) => item.scope.$index = buffer.first + i);\n\n          return {\n            prepended: toBePrepended,\n            removed: toBeRemoved,\n            inserted: inserted,\n            animated: promises\n          };\n\n        }\n\n        function updatePaddings(rid, updates) {\n          // schedule another adjustBuffer after animation completion\n          if (updates.animated.length) {\n            $q.all(updates.animated).then(() => {\n              viewport.adjustPadding();\n              adjustBuffer(rid);\n            });\n          } else {\n            viewport.adjustPadding();\n          }\n        }\n\n        function enqueueFetch(rid, updates) {\n          if (viewport.shouldLoadBottom()) {\n            if (!updates || buffer.effectiveHeight(updates.inserted) > 0) {\n              // this means that at least one item appended in the last batch has height > 0\n              if (pending.push(true) === 1) {\n                fetch(rid);\n                adapter.loading(true);\n              }\n            }\n          } else if (viewport.shouldLoadTop()) {\n            if ((!updates || buffer.effectiveHeight(updates.prepended) > 0) || pending[0]) {\n              // this means that at least one item appended in the last batch has height > 0\n              // pending[0] = true means that previous fetch was appending. We need to force at least one prepend\n              // BTW there will always be at least 1 element in the pending array because bottom is fetched first\n              if (pending.push(false) === 1) {\n                fetch(rid);\n                adapter.loading(true);\n              }\n            }\n          }\n        }\n\n        function adjustBuffer(rid) {\n          if (!rid) { // dismiss pending requests\n            pending = [];\n            rid = ++ridActual;\n          }\n\n          let updates = updateDOM();\n\n          // We need the item bindings to be processed before we can do adjustment\n          $scope.$applyAsync(() => $timeout(() => {\n\n            // show elements after data binging has been done\n            updates.inserted.forEach(w => w.element.removeClass('ng-hide'));\n            updates.prepended.forEach(w => w.element.removeClass('ng-hide'));\n\n            if (isInvalid(rid)) {\n              return;\n            }\n\n            updatePaddings(rid, updates);\n            enqueueFetch(rid);\n\n            if (!pending.length) {\n              adapter.calculateProperties();\n            }\n          }));\n        }\n\n        function adjustBufferAfterFetch(rid) {\n          let updates = updateDOM();\n\n          // We need the item bindings to be processed before we can do adjustment\n          $scope.$applyAsync(() => $timeout(() => {\n            // show elements after data binging has been done\n            updates.inserted.forEach(w => w.element.removeClass('ng-hide'));\n            updates.prepended.forEach(w => w.element.removeClass('ng-hide'));\n\n            viewport.adjustScrollTopAfterPrepend(updates);\n\n            if (isInvalid(rid)) {\n              return;\n            }\n\n            updatePaddings(rid, updates);\n            enqueueFetch(rid, updates);\n            pending.shift();\n\n            if (pending.length)\n              fetch(rid);\n            else {\n              adapter.loading(false);\n              bindEvents();\n              adapter.calculateProperties();\n            }\n          }));\n        }\n\n        function fetch(rid) {\n          if (pending[0]) {// scrolling down\n            if (buffer.length && !viewport.shouldLoadBottom()) {\n              adjustBufferAfterFetch(rid);\n            } else {\n              fetchNext((result) => {\n                if (isInvalid(rid)) {\n                  return;\n                }\n\n                if (result.length < bufferSize) {\n                  buffer.eof = true;\n                }\n\n                if (result.length > 0) {\n                  viewport.clipTop();\n                  buffer.append(result);\n                }\n\n                adjustBufferAfterFetch(rid);\n              });\n            }\n          } else {  // scrolling up\n            if (buffer.length && !viewport.shouldLoadTop()) {\n              adjustBufferAfterFetch(rid);\n            } else {\n              fetchPrevious((result) => {\n                if (isInvalid(rid)) {\n                  return;\n                }\n\n                if (result.length < bufferSize) {\n                  buffer.bof = true;\n                  // log 'bof is reached'\n                }\n\n                if (result.length > 0) {\n                  if (buffer.length) {\n                    viewport.clipBottom();\n                  }\n                  buffer.prepend(result);\n                }\n\n                adjustBufferAfterFetch(rid);\n              });\n            }\n          }\n        }\n\n        function resizeAndScrollHandler() {\n          if (!$rootScope.$$phase && !adapter.isLoading && !adapter.disabled) {\n\n            enqueueFetch(ridActual);\n\n            if (pending.length) {\n              unbindEvents();\n            } else {\n              adapter.calculateProperties();\n              $scope.$apply();\n            }\n          }\n        }\n\n        function wheelHandler(event) {\n          if (!adapter.disabled) {\n            let scrollTop = viewport[0].scrollTop;\n            let yMax = viewport[0].scrollHeight - viewport[0].clientHeight;\n\n            if ((scrollTop === 0 && !buffer.bof) || (scrollTop === yMax && !buffer.eof)) {\n              event.preventDefault();\n            }\n          }\n        }\n      }\n\n    }\n  ]);\n\n\n// WEBPACK FOOTER //\n// ./src/ui-scroll.js"],"sourceRoot":""}