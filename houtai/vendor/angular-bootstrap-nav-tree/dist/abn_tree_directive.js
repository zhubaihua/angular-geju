(function(){var n,e=[].indexOf||function(n){for(var e=0,r=this.length;e<r;e++)if(e in this&&this[e]===n)return e;return-1};n=angular.module("angularBootstrapNavTree",[]),n.directive("abnTree",["$timeout",function(n){return{restrict:"E",template:'<ul class="nav nav-list nav-pills nav-stacked abn-tree">\n  <li ng-repeat="row in tree_rows | filter:{visible:true} track by row.branch.uid" ng-animate="\'abn-tree-animate\'" ng-class="\'level-\' + {{ row.level }} + (row.branch.selected ? \' active\':\'\') + \' \' +row.classes.join(\' \')" class="abn-tree-row"><a ng-click="user_clicks_branch(row.branch)"><i ng-class="row.tree_icon" ng-click="row.branch.expanded = !row.branch.expanded" class="indented tree-icon"> </i><span class="indented tree-label">{{ row.label }} </span></a></li>\n</ul>',replace:!0,scope:{treeData:"=",onSelect:"&",initialSelection:"@",treeControl:"="},link:function(r,t,l){var i,a,c,u,o,s,f,d,h,_;if(function(n){console.log("ERROR:"+n)},null==l.iconExpand&&(l.iconExpand="icon-plus  glyphicon glyphicon-plus  fa fa-plus"),null==l.iconCollapse&&(l.iconCollapse="icon-minus glyphicon glyphicon-minus fa fa-minus"),null==l.iconLeaf&&(l.iconLeaf="icon-file  glyphicon glyphicon-file  fa fa-file"),null==l.expandLevel&&(l.expandLevel="3"),a=parseInt(l.expandLevel,10),!r.treeData)return void alert("no treeData defined for the tree!");if(null==r.treeData.length){if(null==treeData.label)return void alert("treeData should be an array of root branches");r.treeData=[treeData]}return u=function(n){var e,t,l,i,a,c;for(e=function(r,t){var l,i,a,c,u;if(n(r,t),null!=r.children){for(c=r.children,u=[],i=0,a=c.length;i<a;i++)l=c[i],u.push(e(l,t+1));return u}},a=r.treeData,c=[],l=0,i=a.length;l<i;l++)t=a[l],c.push(e(t,1));return c},h=null,d=function(e){if(!e)return null!=h&&(h.selected=!1),void(h=null);if(e!==h){if(null!=h&&(h.selected=!1),e.selected=!0,h=e,i(e),null!=e.onSelect)return n(function(){return e.onSelect(e)});if(null!=r.onSelect)return n(function(){return r.onSelect({branch:e})})}},r.user_clicks_branch=function(n){if(n!==h)return d(n)},o=function(n){var e;return e=void 0,n.parent_uid&&u(function(r){if(r.uid===n.parent_uid)return e=r}),e},c=function(n,e){var r;if(null!=(r=o(n)))return e(r),c(r,e)},i=function(n){return c(n,function(n){return n.expanded=!0})},r.tree_rows=[],f=function(){var n,t,i,a,c,o;for(u(function(n,e){if(!n.uid)return n.uid=""+Math.random()}),u(function(n){var e,r,t,l,i;if(angular.isArray(n.children)){for(l=n.children,i=[],r=0,t=l.length;r<t;r++)e=l[r],i.push(e.parent_uid=n.uid);return i}}),r.tree_rows=[],u(function(n){var e,r;return n.children?n.children.length>0?(r=function(n){return"string"==typeof n?{label:n,children:[]}:n},n.children=function(){var t,l,i,a;for(i=n.children,a=[],t=0,l=i.length;t<l;t++)e=i[t],a.push(r(e));return a}()):void 0:n.children=[]}),n=function(t,i,a){var c,u,o,s,f,d,h;if(null==i.expanded&&(i.expanded=!1),null==i.classes&&(i.classes=[]),i.noLeaf||i.children&&0!==i.children.length?o=i.expanded?l.iconCollapse:l.iconExpand:(o=l.iconLeaf,e.call(i.classes,"leaf")<0&&i.classes.push("leaf")),r.tree_rows.push({level:t,branch:i,label:i.label,classes:i.classes,tree_icon:o,visible:a}),null!=i.children){for(d=i.children,h=[],s=0,f=d.length;s<f;s++)c=d[s],u=a&&i.expanded,h.push(n(t+1,c,u));return h}},c=r.treeData,o=[],i=0,a=c.length;i<a;i++)t=c[i],o.push(n(1,t,!0));return o},r.$watch("treeData",f,!0),null!=l.initialSelection&&u(function(e){if(e.label===l.initialSelection)return n(function(){return d(e)})}),s=r.treeData.length,u(function(n,e){return n.level=e,n.expanded=n.level<a}),null!=r.treeControl&&angular.isObject(r.treeControl)?(_=r.treeControl,_.expand_all=function(){return u(function(n,e){return n.expanded=!0})},_.collapse_all=function(){return u(function(n,e){return n.expanded=!1})},_.get_first_branch=function(){if((s=r.treeData.length)>0)return r.treeData[0]},_.select_first_branch=function(){var n;return n=_.get_first_branch(),_.select_branch(n)},_.get_selected_branch=function(){return h},_.get_parent_branch=function(n){return o(n)},_.select_branch=function(n){return d(n),n},_.get_children=function(n){return n.children},_.select_parent_branch=function(n){var e;if(null==n&&(n=_.get_selected_branch()),null!=n&&null!=(e=_.get_parent_branch(n)))return _.select_branch(e),e},_.add_branch=function(n,e){return null!=n?(n.children.push(e),n.expanded=!0):r.treeData.push(e),e},_.add_root_branch=function(n){return _.add_branch(null,n),n},_.expand_branch=function(n){if(null==n&&(n=_.get_selected_branch()),null!=n)return n.expanded=!0,n},_.collapse_branch=function(n){if(null==n&&(n=h),null!=n)return n.expanded=!1,n},_.get_siblings=function(n){var e;if(null==n&&(n=h),null!=n)return e=_.get_parent_branch(n),e?e.children:r.treeData},_.get_next_sibling=function(n){var e,r;if(null==n&&(n=h),null!=n&&(r=_.get_siblings(n),s=r.length,(e=r.indexOf(n))<s))return r[e+1]},_.get_prev_sibling=function(n){var e,r;if(null==n&&(n=h),r=_.get_siblings(n),s=r.length,(e=r.indexOf(n))>0)return r[e-1]},_.select_next_sibling=function(n){var e;if(null==n&&(n=h),null!=n&&null!=(e=_.get_next_sibling(n)))return _.select_branch(e)},_.select_prev_sibling=function(n){var e;if(null==n&&(n=h),null!=n&&null!=(e=_.get_prev_sibling(n)))return _.select_branch(e)},_.get_first_child=function(n){var e;if(null==n&&(n=h),null!=n&&(null!=(e=n.children)?e.length:void 0)>0)return n.children[0]},_.get_closest_ancestor_next_sibling=function(n){var e,r;return e=_.get_next_sibling(n),null!=e?e:(r=_.get_parent_branch(n),_.get_closest_ancestor_next_sibling(r))},_.get_next_branch=function(n){var e;if(null==n&&(n=h),null!=n)return e=_.get_first_child(n),null!=e?e:e=_.get_closest_ancestor_next_sibling(n)},_.select_next_branch=function(n){var e;if(null==n&&(n=h),null!=n&&null!=(e=_.get_next_branch(n)))return _.select_branch(e),e},_.last_descendant=function(n){var e;return s=n.children.length,0===s?n:(e=n.children[s-1],_.last_descendant(e))},_.get_prev_branch=function(n){var e;if(null==n&&(n=h),null!=n)return e=_.get_prev_sibling(n),null!=e?_.last_descendant(e):_.get_parent_branch(n)},_.select_prev_branch=function(n){var e;if(null==n&&(n=h),null!=n&&null!=(e=_.get_prev_branch(n)))return _.select_branch(e),e}):void 0}}}])}).call(this);