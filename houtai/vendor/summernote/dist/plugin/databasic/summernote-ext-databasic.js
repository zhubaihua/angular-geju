!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){var t=e.summernote.ui,o=e.summernote.dom,a=function(a){var n=this,i=a.options,r=i.langInfo;n.icon='<i class="fa fa-object-group"/>',a.memo("button.databasic",function(){return t.button({contents:n.icon,tooltip:r.databasic.insert,click:a.createInvokeHandler("databasic.showDialog")}).render()}),a.memo("button.databasicDialog",function(){return t.button({contents:n.icon,tooltip:r.databasic.edit,click:a.createInvokeHandler("databasic.showDialog")}).render()}),a.memo("button.databasicSize100",function(){return t.button({contents:'<span class="note-fontsize-10">100%</span>',tooltip:r.image.resizeFull,click:a.createInvokeHandler("editor.resize","1")}).render()}),a.memo("button.databasicSize50",function(){return t.button({contents:'<span class="note-fontsize-10">50%</span>',tooltip:r.image.resizeHalf,click:a.createInvokeHandler("editor.resize","0.5")}).render()}),a.memo("button.databasicSize25",function(){return t.button({contents:'<span class="note-fontsize-10">25%</span>',tooltip:r.image.resizeQuarter,click:a.createInvokeHandler("editor.resize","0.25")}).render()}),n.events={"summernote.init":function(t,o){e("data.ext-databasic",o.editable).each(function(){n.setContent(e(this))})},"summernote.keyup summernote.mouseup summernote.change summernote.scroll":function(){n.update()},"summernote.dialog.shown":function(){n.hidePopover()}},n.initialize=function(){var o=i.dialogsInBody?e(document.body):a.layoutInfo.editor,s='<div class="form-group row-fluid"><label>'+r.databasic.testLabel+'</label><input class="ext-databasic-test form-control" type="text" /></div>',d='<button href="#" class="btn btn-primary ext-databasic-save">'+r.databasic.insert+"</button>";n.$dialog=t.dialog({title:r.databasic.name,fade:i.dialogsFade,body:s,footer:d}).render().appendTo(o),n.$popover=t.popover({className:"ext-databasic-popover"}).render().appendTo("body");var c=n.$popover.find(".popover-content");a.invoke("buttons.build",c,i.popover.databasic)},n.destroy=function(){n.$popover.remove(),n.$popover=null,n.$dialog.remove(),n.$dialog=null},n.update=function(){if(!a.invoke("editor.hasFocus"))return void n.hidePopover();var t=a.invoke("editor.createRange"),i=!1;if(t.isOnData()){var r=e(t.sc).closest("data.ext-databasic");if(r.length){var s=o.posFromPlaceholder(r[0]);n.$popover.css({display:"block",left:s.left,top:s.top}),a.invoke("editor.saveTarget",r[0]),i=!0}}i||n.hidePopover()},n.hidePopover=function(){n.$popover.hide()},n.getInfo=function(){var t=a.invoke("editor.createRange");if(t.isOnData()){var o=e(t.sc).closest("data.ext-databasic");if(o.length)return{node:o,test:o.attr("data-test")}}return{}},n.setContent=function(e){e.html('<p contenteditable="false">'+n.icon+" "+r.databasic.name+": "+e.attr("data-test")+"</p>")},n.updateNode=function(e){n.setContent(e.node.attr("data-test",e.test))},n.createNode=function(t){var o=e('<data class="ext-databasic"></data>');return o&&(t.node=o,a.invoke("editor.insertNode",o[0])),o},n.showDialog=function(){var o=n.getInfo(),i=!o.node;a.invoke("editor.saveRange"),n.openDialog(o).then(function(r){t.hideDialog(n.$dialog),a.invoke("editor.restoreRange"),i&&n.createNode(o),e.extend(o,r),n.updateNode(o)}).fail(function(){a.invoke("editor.restoreRange")})},n.openDialog=function(o){return e.Deferred(function(e){var i=n.$dialog.find(".ext-databasic-test"),s=n.$dialog.find(".ext-databasic-save"),d=function(e){13===e.keyCode&&s.trigger("click")};t.onDialogShown(n.$dialog,function(){a.triggerEvent("dialog.shown"),i.val(o.test).on("input",function(){t.toggleBtn(s,i.val())}).trigger("focus").on("keyup",d),s.text(o.node?r.databasic.edit:r.databasic.insert).click(function(t){t.preventDefault(),e.resolve({test:i.val()})}),t.toggleBtn(s,i.val())}),t.onDialogHidden(n.$dialog,function(){i.off("input keyup"),s.off("click"),"pending"===e.state()&&e.reject()}),t.showDialog(n.$dialog)})}};e.extend(!0,e.summernote,{plugins:{databasic:a},options:{popover:{databasic:[["databasic",["databasicDialog","databasicSize100","databasicSize50","databasicSize25"]]]}},lang:{"en-US":{databasic:{name:"Basic Data Container",insert:"insert basic data container",edit:"edit basic data container",testLabel:"test input"}}}})});