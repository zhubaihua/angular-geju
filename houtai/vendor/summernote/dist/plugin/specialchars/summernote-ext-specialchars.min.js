!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof module&&module.exports?module.exports=e(require("jquery")):e(window.jQuery)}(function(e){e.extend(e.summernote.plugins,{specialchars:function(o){var t,n,i,r=this,a=e.summernote.ui,l=o.layoutInfo.editor,d=o.options,u=d.langInfo,c={UP:38,DOWN:40,LEFT:37,RIGHT:39,ENTER:13},s=15,f=0,p=["&quot;","&amp;","&lt;","&gt;","&iexcl;","&cent;","&pound;","&curren;","&yen;","&brvbar;","&sect;","&uml;","&copy;","&ordf;","&laquo;","&not;","&reg;","&macr;","&deg;","&plusmn;","&sup2;","&sup3;","&acute;","&micro;","&para;","&middot;","&cedil;","&sup1;","&ordm;","&raquo;","&frac14;","&frac12;","&frac34;","&iquest;","&times;","&divide;","&fnof;","&circ;","&tilde;","&ndash;","&mdash;","&lsquo;","&rsquo;","&sbquo;","&ldquo;","&rdquo;","&bdquo;","&dagger;","&Dagger;","&bull;","&hellip;","&permil;","&prime;","&Prime;","&lsaquo;","&rsaquo;","&oline;","&frasl;","&euro;","&image;","&weierp;","&real;","&trade;","&alefsym;","&larr;","&uarr;","&rarr;","&darr;","&harr;","&crarr;","&lArr;","&uArr;","&rArr;","&dArr;","&hArr;","&forall;","&part;","&exist;","&empty;","&nabla;","&isin;","&notin;","&ni;","&prod;","&sum;","&minus;","&lowast;","&radic;","&prop;","&infin;","&ang;","&and;","&or;","&cap;","&cup;","&int;","&there4;","&sim;","&cong;","&asymp;","&ne;","&equiv;","&le;","&ge;","&sub;","&sup;","&nsub;","&sube;","&supe;","&oplus;","&otimes;","&perp;","&sdot;","&lceil;","&rceil;","&lfloor;","&rfloor;","&loz;","&spades;","&clubs;","&hearts;","&diams;"];o.memo("button.specialCharacter",function(){return a.button({contents:'<i class="fa fa-font fa-flip-vertical">',tooltip:u.specialChar.specialChar,click:function(){r.show()}}).render()}),this.makeSpecialCharSetTable=function(){var o=e("<table/>");return e.each(p,function(t,n){var i=e("<td/>").addClass("note-specialchar-node"),r=t%s==0?e("<tr/>"):o.find("tr").last(),l=a.button({callback:function(e){e.html(n),e.attr("title",n),e.attr("data-value",encodeURIComponent(n)),e.css({width:35,"margin-right":"2px","margin-bottom":"2px"})}}).render();i.append(l),r.append(i),t%s==0&&o.append(r)}),f=o.find("tr").length,i=s,o},this.initialize=function(){var o=d.dialogsInBody?e(document.body):l,t='<div class="form-group row-fluid">'+this.makeSpecialCharSetTable()[0].outerHTML+"</div>";this.$dialog=a.dialog({title:u.specialChar.select,body:t}).render().appendTo(o)},this.show=function(){var t=o.invoke("editor.getSelectedText");o.invoke("editor.saveRange"),this.showSpecialCharDialog(t).then(function(t){o.invoke("editor.restoreRange");var n=e("<span></span>").html(t)[0];n&&o.invoke("editor.insertNode",n)}).fail(function(){o.invoke("editor.restoreRange")})},this.showSpecialCharDialog=function(o){return e.Deferred(function(l){function d(e){e&&(e.find("button").addClass("active"),y=e)}function u(e){e.find("button").removeClass("active"),y=null}function p(o,t){var n=null;return e.each(b,function(e,i){var r=Math.ceil((e+1)/s),a=(e+1)%s==0?s:(e+1)%s;if(r===o&&a===t)return n=i,!1}),e(n)}function m(e){var o,r=b.length%i;c.LEFT===e?t>1?t-=1:1===n&&1===t?(t=r,n=f):(t=i,n-=1):c.RIGHT===e?n===f&&r===t?(t=1,n=1):t<i?t+=1:(t=1,n+=1):c.UP===e?1===n&&r<t?n=f-1:n-=1:c.DOWN===e&&(n+=1),n===f&&t>r?n=1:n>f?n=1:n<1&&(n=f),(o=p(n,t))&&(u(y),d(o))}function h(){y&&(l.resolve(decodeURIComponent(y.find("button").attr("data-value"))),v.modal("hide"))}function g(e){e.preventDefault();var o=e.keyCode;if(void 0!==o&&null!==o){if(q.indexOf(o)>-1){if(null===y)return d(b.eq(0)),t=1,void(n=1);m(o)}else o===C&&h();return!1}}var v=r.$dialog,b=v.find(".note-specialchar-node"),y=null,q=[c.UP,c.DOWN,c.LEFT,c.RIGHT],C=c.ENTER;if(u(b),o)for(var k=0;k<b.length;k++){var w=e(b[k]);w.text()===o&&(d(w),n=Math.ceil((k+1)/s),t=(k+1)%s)}a.onDialogShown(r.$dialog,function(){e(document).on("keydown",g),r.$dialog.find("button").tooltip(),b.on("click",function(o){o.preventDefault(),l.resolve(decodeURIComponent(e(o.currentTarget).find("button").attr("data-value"))),a.hideDialog(r.$dialog)})}),a.onDialogHidden(r.$dialog,function(){b.off("click"),r.$dialog.find("button").tooltip("destroy"),e(document).off("keydown",g),"pending"===l.state()&&l.reject()}),a.showDialog(r.$dialog)})}}})});